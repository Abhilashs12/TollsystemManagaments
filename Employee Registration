Imports System.Data.SqlClient 
Imports System.Net.MailImports System.Data.SqlClient 
Public Class tollcollectionsearch
Private Sub tollcollectionsearch_Load (ByVal sender As System.Object, ByVal e As 
System.EventArgs) Handles MyBase.Load 
Me.WindowState = FormWindowState.Maximized 
If Conn.State = ConnectionState.Open Then Conn.Close () 
Conn.Open () 
Dim Cmd1 As New SqlCommand("Select cntrnm from tolldet order by cntrnm", Conn) 
Dim D1 As SqlDataReader = Cmd1.ExecuteReader() 
While D1.Read 
ComboBox1.Items.Add(D1 (0).ToString) 
End While 
If Conn.State = ConnectionState.Open Then Conn.Close () 
Conn.Open () 
Dim Cmd2 As New SqlCommand ("Select nobooth from tolldet order by nobooth", Conn) 
Dim D2 As SqlDataReader = Cmd2.ExecuteReader () 
While D2.Read 
ComboBox2.Items.Add (D2 (0).ToString) 
End While 
End Sub 
Private Sub Button1_Click (ByVal sender As System.Object, ByVal e As System.EventArgs) 
Handles Button1.Click 
If Conn.State = ConnectionState.Open Then Conn.Close () 
Conn.Open () 
Dim DS1 As New DataSet 
Dim adp As New SqlDataAdapter("Select * From tolldet where cntrnm='" & 
ComboBox1.Text & "' and nobooth='" & ComboBox2.Text & "' ", Conn) 
adp.Fill(DS1) 
DG1.DataSource = DS1.Tables(0) 
If Conn.State = ConnectionState.Open Then Conn.Close() 
End Sub 
Private Sub Button2_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) 
Handles Button2.Click 
Me.Close () 
End Sub 
End Class 
Public Class EMP_REG 
Dim q1Var, q2Var, pkVar As String 
Private 
Sub 
EMP_REG_Load(ByVal sender As System.Object, ByVal e As 
System.EventArgs) Handles MyBase.Load 
Private Sub Button7_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) 
Handles Button7.Click 
TextBox1.Text = "" 
TextBox2.Text = "" 
TextBox3.Text = "" 
TextBox4.Text = "" 
TextBox5.Text = "" 
TextBox6.Text = "" 
ComboBox1.Text = "" 
ComboBox2.Text = "" 
End Sub 
Private Sub Button8_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) 
Handles Button8.Click 
SaveRecord() 
End Sub 
Sub SaveRecord() 
If TextBox1.Text = "" Then 
MsgBox("Please enter the necessary details") 
Exit Sub 
End If 
If Conn.State = ConnectionState.Open Then Conn.Close() 
Conn.Open() 
Dim Cmd0 As New SqlCommand("select empnm from empreg where empnm='" & 
UCase(TextBox1.Text) & "'", Conn) 
Dim D1 As SqlDataReader = Cmd0.ExecuteReader() 
If D1.HasRows Then 
MsgBox("This record is allready present in the database") 
If Conn.State = ConnectionState.Open Then Conn.Close() 
Exit Sub 
End If 
If Conn.State = ConnectionState.Open Then Conn.Close() 
Conn.Open() 
q1Var = "insert into empreg(" 
q2Var = " values(" 
q1Var = q1Var & "empnm" & "," 
q2Var = q2Var & "'" & (TextBox1.Text) & "'," 
q1Var = q1Var & "empcode" & "," 
q2Var = q2Var & "'" & (TextBox2.Text) & "'," 
q1Var = q1Var & "address" & "," 
q2Var = q2Var & "'" & (TextBox3.Text) & "'," 
q1Var = q1Var & "dob" & "," 
q2Var = q2Var & "'" & (TextBox4.Text) & "'," 
q1Var = q1Var & "mob" & "," 
q2Var = q2Var & "'" & (TextBox5.Text) & "',"
q1Var = q1Var & "email" & "," 
q2Var = q2Var & "'" & (TextBox6.Text) & "'," 
q1Var = q1Var & "qua" & "," 
q2Var = q2Var & "'" & (ComboBox1.Text) & "'," 
q1Var = q1Var & "desig" & ")" 
q2Var = q2Var & "'" & ComboBox2.Text & "')" 
Dim cmd1 As New SqlCommand(q1Var & q2Var, Conn) 
cmd1.ExecuteNonQuery() 
If Conn.State = ConnectionState.Open Then Conn.Close() 
'    Dim Mail As New MailMessage 
'    Mail.Subject = "Your Account Has Been Approved!!!" 
'    If TextBox5.Text = "" Then 
'    
MsgBox("Please Enter The E-Mail Address", MsgBoxStyle.Information + 
MsgBoxStyle.OkOnly, "Error!") 
'    End If 
'    Mail.To.Add(TextBox6.Text) 
'    Mail.From = New MailAddress("pavi.shet18@gmail.com") 
'    
Mail.Body = ("Your account id=" & TextBox1.Text & " and name=" & TextBox2.Text 
& " ") 
'    Dim SMTP As New SmtpClient("smtp.gmail.com") 
'    SMTP.EnableSsl = True 
'    
SMTP.Credentials = New System.Net.NetworkCredential("pavi.shet18@gmail.com", 
"themonk1919") 
'    SMTP.Port = "587" 
'    SMTP.Send(Mail) 
MsgBox("Approved Successfully") 
disRecords() 
End Sub 
Private Sub Button9_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) 
Handles Button9.Click 
If vbNo = MsgBox("Are you sure you want modify", MsgBoxStyle.YesNo, "Modify") 
Then Exit Sub 
If Conn.State = ConnectionState.Open Then Conn.Close() 
Conn.Open() 
Dim cmd1 As New SqlCommand("Delete from empreg where empnm='" & pkVar & "'", 
Conn) 
cmd1.ExecuteNonQuery() 
If Conn.State = ConnectionState.Open Then Conn.Close() 
SaveRecord() 
End Sub 
Private Sub Button10_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) 
Handles Button10.Click
If vbNo = MsgBox("Are you sure you want Delete", MsgBoxStyle.YesNo, "Delete") Then 
Exit Sub 
If Conn.State = ConnectionState.Open Then Conn.Close() 
Conn.Open() 
Dim cmd1 As New SqlCommand("Delete from empreg where empnm='" & pkVar & "'", 
Conn) 
cmd1.ExecuteNonQuery() 
If Conn.State = ConnectionState.Open Then Conn.Close() 
disRecords() 
End Sub 
Sub disRecords() 
If Conn.State = ConnectionState.Open Then Conn.Close() 
Conn.Open() 
Dim DS1 As New DataSet 
Dim adp As New SqlDataAdapter("Select * From empreg", Conn) 
adp.Fill(DS1) 
DataGridView1.DataSource = DS1.Tables(0) 
If Conn.State = ConnectionState.Open Then Conn.Close() 
End Sub 
Private Sub Button11_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) 
Handles Button11.Click 
Me.Close() 
End Sub 
Private Sub DataGridView1_CellContentClick(ByVal sender As System.Object, ByVal e As 
System.Windows.Forms.DataGridViewCellEventArgs) 
End Sub 
Private Sub DataGridView1_CellContentClick_1(ByVal sender As System.Object, ByVal e 
As 
System.Windows.Forms.DataGridViewCellEventArgs) 
DataGridView1.CellContentClick 
End Sub 
Handles 
Private Sub DataGridView1_CellMouseClick(ByVal sender As Object, ByVal e As 
System.Windows.Forms.DataGridViewCellMouseEventArgs) 
Handles 
DataGridView1.CellMouseClick 
pkVar = DataGridView1.CurrentRow.Cells(0).Value 
If Conn.State = ConnectionState.Open Then Conn.Close() 
Conn.Open() 
Dim cmd0 As New SqlCommand("Select * from empreg where empnm='" & pkVar & "'", 
Conn) 
Dim D1 As SqlDataReader = cmd0.ExecuteReader() 
If D1.HasRows Then
1.Read() 
TextBox1.Text = D1(0).ToString 
TextBox2.Text = D1(1).ToString 
TextBox3.Text = D1(2).ToString 
TextBox4.Text = D1(3).ToString 
TextBox5.Text = D1(4).ToString 
TextBox6.Text = D1(5).ToString 
Else 
TextBox1.Text = "" 
TextBox2.Text = "" 
End If 
End Sub 
End Clas

disRecords() 
End Sub 
