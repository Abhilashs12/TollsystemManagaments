Imports System.Data.SqlClient 
Public Class tollcollection 
Dim q1Var, q2Var As String 
Dim pkVar As String 
Private Sub Button3_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) 
Handles Button3.Click 
If vbNo = MsgBox("Are you sure you want modify", MsgBoxStyle.YesNo, "Modify") 
Then Exit Sub    If Conn.State = ConnectionState.Open Then Conn.Close() 
        Conn.Open() 
        Dim cmd1 As New SqlCommand("Delete from toco where tn='" & pkVar & "'", Conn) 
        cmd1.ExecuteNonQuery() 
        If Conn.State = ConnectionState.Open Then Conn.Close() 
        SaveRecord() 
         
    End Sub 
    Private Sub Button2_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) 
Handles Button2.Click 
        SaveRecord() 
         
    End Sub 
    Sub SaveRecord() 
        If TextBox1.Text = "" Then 
            MsgBox("Please enter the necessary details") 
            Exit Sub 
        End If 
        If Conn.State = ConnectionState.Open Then Conn.Close() 
        Conn.Open() 
        Dim Cmd0 As New SqlCommand("select tn from toco where tn='" & 
UCase(TextBox1.Text) & "'", Conn) 
        Dim D1 As SqlDataReader = Cmd0.ExecuteReader() 
        If D1.HasRows Then 
            MsgBox("This record is allready present in the database") 
            If Conn.State = ConnectionState.Open Then Conn.Close() 
            Exit Sub 
        End If 
 
        If Conn.State = ConnectionState.Open Then Conn.Close() 
        Conn.Open() 
        q1Var = "insert into toco(" 
        q2var = " values(" 
        q1Var = q1Var & "tn" & "," 
        q2Var = q2Var & "'" & UCase(TextBox1.Text) & "'," 
        q1Var = q1Var & "td" & "," 
        q2Var = q2Var & "'" & UCase(DateTimePicker1.Text) & "'," 
        q1Var = q1Var & "tc" & "," 
        q2Var = q2Var & "'" & UCase(ComboBox1.Text) & "'," 
        q1Var = q1Var & "bn" & "," 
        q2Var = q2Var & "'" & UCase(ComboBox2.Text) & "'," 
        q1Var = q1Var & "pn" & "," 
        q2Var = q2Var & "'" & UCase(ComboBox3.Text) & "'," 
        q1Var = q1Var & "vt" & "," 
q2Var = q2Var & "'" & UCase(TextBox2.Text) & "'," 
q1Var = q1Var & "tf" & "," 
q2Var = q2Var & "'" & UCase(TextBox3.Text) & "'," 
q1Var = q1Var & "det" & "," 
q2Var = q2Var & "'" & UCase(TextBox3.Text) & "'," 
q1Var = q1Var & "frmplc" & "," 
q2Var = q2Var & "'" & UCase(ComboBox5.Text) & "'," 
q1Var = q1Var & "toplc" & ")" 
q2Var = q2Var & "'" & ComboBox6.Text & "')" 
Dim cmd1 As New SqlCommand(q1var & q2var, Conn) 
cmd1.ExecuteNonQuery() 
If Conn.State = ConnectionState.Open Then Conn.Close() 
disRecords() 
End Sub 
Private Sub Button4_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) 
Handles Button4.Click 
If vbNo = MsgBox("Are you sure you want Delete", MsgBoxStyle.YesNo, "Delete") Then 
Exit Sub 
If Conn.State = ConnectionState.Open Then Conn.Close() 
Conn.Open() 
Dim cmd1 As New SqlCommand("Delete from toco where tn='" & pkVar & "'", Conn) 
cmd1.ExecuteNonQuery() 
If Conn.State = ConnectionState.Open Then Conn.Close() 
disRecords() 
End Sub 
Sub disRecords() 
If Conn.State = ConnectionState.Open Then Conn.Close() 
Conn.Open() 
Dim DS1 As New DataSet 
Dim adp As New SqlDataAdapter("Select * From toco order by tn", Conn) 
adp.Fill(DS1) 
DataGridView1.DataSource = DS1.Tables(0) 
If Conn.State = ConnectionState.Open Then Conn.Close() 
End Sub 
Private 
Sub tollcollection_Load(ByVal sender As System.Object, ByVal e As 
System.EventArgs) Handles MyBase.Load 
disRecords() 
Me.WindowState = FormWindowState.Maximized 
If Conn.State = ConnectionState.Open Then Conn.Close() 
Conn.Open() 
Dim Cmd1 As New SqlCommand("Select cntrnm from tolldet order by cntrnm", Conn) 
Dim D1 As SqlDat

ComboBox1.Items.Add(D1(0).ToString) 
End While 
If Conn.State = ConnectionState.Open Then Conn.Close() 
Conn.Open() 
Dim Cmd2 As New SqlCommand("Select nobooth from tolldet order by nobooth", Conn) 
Dim D2 As SqlDataReader = Cmd2.ExecuteReader() 
While D2.Read() 
ComboBox2.Items.Add(D2(0).ToString) 
End While 
If Conn.State = ConnectionState.Open Then Conn.Close() 
Conn.Open() 
Dim Cmd3 As New SqlCommand("Select plcnm from tolldet order by plcnm", Conn) 
Dim D3 As SqlDataReader = Cmd3.ExecuteReader() 
While D3.Read 
ComboBox3.Items.Add(D3(0).ToString) 
End While 
If Conn.State = ConnectionState.Open Then Conn.Close() 
Conn.Open() 
Dim Cmd4 As New SqlCommand("Select vehcltype from tollpri order by vehcltype", 
Conn) 
Dim D4 As SqlDataReader = Cmd4.ExecuteReader() 
While D4.Read 
ComboBox4.Items.Add(D4(0).ToString) 
End While 
If Conn.State = ConnectionState.Open Then Conn.Close() 
Conn.Open() 
Dim Cmd5 As New SqlCommand("Select frmplc from tollpri order by frmplc", Conn) 
Dim D5 As SqlDataReader = Cmd5.ExecuteReader() 
While D5.Read 
ComboBox5.Items.Add(D5(0).ToString) 
End While 
If Conn.State = ConnectionState.Open Then Conn.Close() 
Conn.Open() 
Dim Cmd6 As New SqlCommand("Select toplc from tollpri order by toplc", Conn) 
Dim D6 As SqlDataReader = Cmd6.ExecuteReader() 
While D6.Read 
ComboBox6.Items.Add(D6(0).ToString) 
End While 
End Sub 
Private Sub DataGridView1_CellContentClick(ByVal sender As System.Object, ByVal e As 
System.Windows.Forms.DataGridViewCellEventArgs) 
Handles 
DataGridView1.CellContentClick 
pkVar = DataGridView1.CurrentRow.Cells(0).Value 
If Conn.State = ConnectionState.Open Then Conn.Close() 
Conn.Open() 
Dim cmd0 As New SqlCommand("Select * from toco where tn='" & pkVar & "'", Conn) 
        Dim D1 As SqlDataReader = cmd0.ExecuteReader() 
        If D1.HasRows Then 
            D1.Read() 
            TextBox1.Text = D1(0).ToString 
            TextBox2.Text = D1(1).ToString 
            TextBox3.Text = D1(2).ToString 
            TextBox4.Text = D1(3).ToString 
             
        Else 
            TextBox1.Text = "" 
            TextBox2.Text = "" 
             
        End If 
    End Sub 
 
    Private Sub Button5_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) 
Handles Button5.Click 
        Me.Close() 
    End Sub 
 
 
 
    Private Sub Button1_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) 
Handles Button1.Click 
        TextBox1.Text = "" 
        TextBox2.Text = "" 
        TextBox3.Text = "" 
        TextBox4.Text = "" 
        ComboBox1.Text = "" 
        ComboBox2.Text = "" 
        ComboBox3.Text = "" 
        ComboBox4.Text = "" 
        ComboBox5.Text = "" 
        ComboBox6.Text = "" 
    End Sub 
    Private Sub Label10_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) 
Handles Label10.Click 
 
    End Sub 
 
    Private Sub ComboBox6_SelectedIndexChanged(ByVal sender As System.Object, ByVal e 
As System.EventArgs) Handles ComboBox6.SelectedIndexChanged 
 
    End Sub
Private Sub ComboBox6_SelectedValueChanged(ByVal sender As Object, ByVal e As 
System.EventArgs) Handles ComboBox6.SelectedValueChanged 
If Conn.State = ConnectionState.Open Then Conn.Close() 
Conn.Open() 
Dim cmd0 As New SqlCommand("Select price from tollpri where vehcltype='" & 
ComboBox4.Text & "' and frmplc='" & ComboBox5.Text & "' and toplc='" & ComboBox6.Text 
& "'", Conn) 
Dim D1 As SqlDataReader = cmd0.ExecuteReader() 
If D1.HasRows Then 
D1.Read() 
TextBox3.Text = D1(0).ToString 
Else 
TextBox1.Text = "" 
TextBox2.Text = "" 
End If 
End Sub 
Private Sub PrintDocument1_PrintPage(ByVal sender As System.Object, ByVal e As 
System.Drawing.Printing.PrintPageEventArgs) Handles PrintDocument1.PrintPage 
Dim XPos, YPos As Long 
YPos = 50 
Dim MyFont As New Font("Arial", 18) 
XPos = 10 
e.Graphics.DrawString("TOLL COLLECTION LIST ", MyFont, Brushes.Black, XPos, 
YPos) 
YPos += 50 
MyFont = New Font("Arial", 12) 
e.Graphics.DrawString("No 233, II Floor, UB City, Bangalore", MyFont, Brushes.Black, 
XPos, YPos) 
YPos += 100 
XPos = 10 
e.Graphics.DrawString("TOLL Detail Report", MyFont, Brushes.Black, XPos, YPos) 
YPos += 50 
XPos = 10 
MyFont = New Font("Arial", 12) 
e.Graphics.DrawString("Ticket Number", MyFont, Brushes.Black, XPos, YPos) 
XPos = XPos + 150 
e.Graphics.DrawString("Vehicle number", MyFont, Brushes.Black, XPos, YPos) 
XPos = XPos + 150 
e.Graphics.DrawString("Booth Number", MyFont, Brushes.Black, XPos, YPos) 
XPos = XPos + 150 
e.Graphics.DrawString("from place", MyFont, Brushes.Black, XPos, YPos) 

XPos = XPos + 150 
e.Graphics.DrawString("To Place", MyFont, Brushes.Black, XPos, YPos) 
XPos = XPos + 150 
e.Graphics.DrawString("Price", MyFont, Brushes.Black, XPos, YPos) 
YPos += 25 
For Each r As DataGridViewRow In DataGridView1.Rows 
XPos = 10 
e.Graphics.DrawString(r.Cells(0).Value, MyFont, Brushes.Black, XPos, YPos) 
XPos = XPos + 150 
e.Graphics.DrawString(r.Cells(6).Value, MyFont, Brushes.Black, XPos, YPos) 
XPos = XPos + 150 
e.Graphics.DrawString(r.Cells(3).Value, MyFont, Brushes.Black, XPos, YPos) 
XPos = XPos + 150 
e.Graphics.DrawString(r.Cells(9).Value, MyFont, Brushes.Black, XPos, YPos) 
XPos = XPos + 150 
e.Graphics.DrawString(r.Cells(10).Value, MyFont, Brushes.Black, XPos, YPos) 
XPos = XPos + 150 
e.Graphics.DrawString(r.Cells(7).Value, MyFont, Brushes.Black, XPos, YPos) 
XPos = XPos + 150 
YPos += 50 
Next 
End Sub 
Private Sub Button6_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) 
Handles Button6.Click 
PrintPreviewDialog1.Show() 
End Sub 
Private Sub Button7_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) 
If Conn.State = ConnectionState.Open Then Conn.Close() 
Conn.Open() 
Dim DS1 As New DataSet 
Dim adp As New SqlDataAdapter("Select * From toco order by tn", Conn) 
adp.Fill(DS1) 
DataGridView1.DataSource = DS1.Tables(0) 
If Conn.State = ConnectionState.Open Then Conn.Close() 
End Sub 
End Class 
        q2Var = q2Var & "'" & UCase(ComboBox4.Text) & "'," 
        q1Var = q1Var & "vn" & ","
