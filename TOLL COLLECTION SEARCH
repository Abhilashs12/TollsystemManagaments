 
Imports System.Data.SqlClient 
 
Public Class tollcollectionsearch 
rivate Sub tollcollectionsearch_Load(ByVal sender As System.Object, ByVal e As 
System.EventArgs) Handles MyBase.Load 
Me.WindowState = FormWindowState.Maximized 
If Conn.State = ConnectionState.Open Then Conn.Close() 
Conn.Open() 
Dim Cmd1 As New SqlCommand("Select cntrnm from tolldet order by cntrnm", Conn) 
Dim D1 As SqlDataReader = Cmd1.ExecuteReader() 
While D1.Read 
ComboBox1.Items.Add(D1(0).ToString) 
End While 
If Conn.State = ConnectionState.Open Then Conn.Close() 
Conn.Open() 
Dim Cmd2 As New SqlCommand("Select nobooth from tolldet order by nobooth", Conn) 
Dim D2 As SqlDataReader = Cmd2.ExecuteReader() 
While D2.Read 
ComboBox2.Items.Add(D2(0).ToString) 
End While 
End Sub 
Private Sub Button1_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) 
Handles Button1.Click 
If Conn.State = ConnectionState.Open Then Conn.Close() 
Conn.Open() 
Dim DS1 As New DataSet 
Dim adp As New SqlDataAdapter("Select * From tolldet where cntrnm='" & 
ComboBox1.Text & "' and nobooth='" & ComboBox2.Text & "' ", Conn) 
adp.Fill(DS1) 
DG1.DataSource = DS1.Tables(0) 
If Conn.State = ConnectionState.Open Then Conn.Close() 
End Sub 
Private Sub Button2_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) 
Handles Button2.Click 
Me.Close() 
End Sub 
End Class
