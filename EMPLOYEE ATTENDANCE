Imports System.Data.SqlClient 
Public Class empattendance 
Dim q1Var, q2Var As String 
Private Sub empattendance_Load(ByVal sender As System.Object, ByVal e As 
System.EventArgs) Handles MyBase.Load 
If Conn.State = ConnectionState.Open Then Conn.Close() 
Conn.Open() 
Dim Cmd1 As New SqlCommand("Select empcode from empreg order by empcode", 
Conn) 
Dim D1 As SqlDataReader = Cmd1.ExecuteReader() 
While D1.Read 
ComboBox1.Items.Add(D1(0).ToString) 
End While 
End Sub 
Sub SaveRecord() 
If TextBox1.Text = "" Then 
MsgBox("Please enter the necessary details") 
Exit Sub 
End If 
If Conn.State = ConnectionState.Open Then Conn.Close() 
Conn.Open() 
Dim Cmd0 As New SqlCommand("select tn from toco where tn='" & 
UCase(TextBox1.Text) & "'", Conn) 
Dim D1 As SqlDataReader = Cmd0.ExecuteReader() 
If D1.HasRows Then 
MsgBox("This record is allready present in the database") 
If Conn.State = ConnectionState.Open Then Conn.Close() 
Exit Sub 
End If 
If Conn.State = ConnectionState.Open Then Conn.Close() 
Conn.Open() 
q1Var = "insert into empattn(" 
q2var = " values(" 
q1Var = q1Var & "empcode" & "," 
q2Var = q2Var & "'" & ComboBox1.Text & "'," 
q1Var = q1Var & "empnm" & "," 
q2Var = q2Var & "'" & TextBox1.Text & "'," 
q1Var = q1Var & "date" & "," 
q2Var = q2Var & "'" & DateTimePicker1.Value & "'," 
q1Var = q1Var & "attn" & ")" 
q2Var = q2Var & "'" & ComboBox2.Text & "')" 
Dim cmd1 As New SqlCommand(q1var & q2var, Conn) 
cmd1.ExecuteNonQuery() 
If Conn.State = ConnectionState.Open Then Conn.Close() 
MsgBox("attendance registered") 
End Sub 
Private Sub ComboBox1_SelectedValueChanged(ByVal sender As Object, ByVal e As 
System.EventArgs) Handles ComboBox1.SelectedValueChanged 
If Conn.State = ConnectionState.Open Then Conn.Close() 
Conn.Open() 
Dim Cmd1 As New SqlCommand("Select empnm from empreg where empcode='" & 
ComboBox1.Text & "'", Conn) 
Dim D1 As SqlDataReader = Cmd1.ExecuteReader() 
While D1.Read 
TextBox1.Text = (D1(0).ToString) 
End While 
End Sub 
Private Sub Button1_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) 
Handles Button1.Click 
SaveRecord() 
End Sub 
Private Sub Button2_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) 
Handles Button2.Click 
Me.Close() 
End Sub 
End Class 
